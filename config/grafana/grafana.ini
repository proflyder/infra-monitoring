# ═══════════════════════════════════════════════════════════════════
# Grafana Configuration для Proflyder
# ═══════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────
# General / Instance
# ───────────────────────────────────────────────────────────────────
[default]
# Название инстанса в заголовке браузера и UI
instance_name = Proflyder Monitoring

# ───────────────────────────────────────────────────────────────────
# Paths - управление директориями
# ───────────────────────────────────────────────────────────────────
[paths]
# Директория для плагинов
plugins = /var/lib/grafana/plugins

# Директория для provisioning конфигов (datasources, dashboards)
provisioning = /etc/grafana/provisioning

# ───────────────────────────────────────────────────────────────────
# Server - настройки веб-сервера
# ───────────────────────────────────────────────────────────────────
[server]
# HTTP порт (внутри контейнера, снаружи проксируется через nginx)
http_port = 3000

# Root URL для работы через nginx на /grafana/
root_url = https://proflyder.dev/grafana/

# Обслуживание с sub-path (важно для работы через nginx)
serve_from_sub_path = true

# ───────────────────────────────────────────────────────────────────
# Security - настройки безопасности
# ───────────────────────────────────────────────────────────────────
[security]
# Admin user (переопределяется через env GF_SECURITY_ADMIN_USER)
admin_user = admin

# Admin password (переопределяется через env GF_SECURITY_ADMIN_PASSWORD)
# ВАЖНО: Не храни пароль здесь, только через .env!
# admin_password =

# Отключить регистрацию новых пользователей
disable_initial_admin_creation = false

# Secret key для signing (автоматически генерируется при первом запуске)
# secret_key =

# ───────────────────────────────────────────────────────────────────
# Users - управление пользователями
# ───────────────────────────────────────────────────────────────────
[users]
# Разрешить регистрацию новых пользователей (отключено для безопасности)
allow_sign_up = false

# Разрешить пользователям создавать организации
allow_org_create = true

# Автоматическое назначение организации для новых пользователей
auto_assign_org = true

# Роль по умолчанию для новых пользователей (Viewer, Editor, Admin)
auto_assign_org_role = Viewer

# ───────────────────────────────────────────────────────────────────
# Anonymous Auth - анонимный доступ (отключен)
# ───────────────────────────────────────────────────────────────────
[auth.anonymous]
# Отключить анонимный доступ
enabled = false

# ───────────────────────────────────────────────────────────────────
# Organization - настройки организации
# ───────────────────────────────────────────────────────────────────
[org]
# Название организации по умолчанию
name = Proflyder

# ───────────────────────────────────────────────────────────────────
# Logging - логирование
# ───────────────────────────────────────────────────────────────────
[log]
# Режим логирования: console, file, syslog
mode = console

# Уровень логирования: debug, info, warn, error, critical
level = info

# ───────────────────────────────────────────────────────────────────
# Metrics - внутренние метрики Grafana
# ───────────────────────────────────────────────────────────────────
[metrics]
# Включить метрики Grafana (доступны на /metrics)
enabled = true

# Базовые метрики (использование памяти, горутины и т.д.)
basic_auth_enabled = false

# ───────────────────────────────────────────────────────────────────
# Analytics - отправка аналитики в Grafana Labs (отключено)
# ───────────────────────────────────────────────────────────────────
[analytics]
# Отключить отправку анонимной статистики
reporting_enabled = false

# Отключить проверку обновлений
check_for_updates = false

# ───────────────────────────────────────────────────────────────────
# Dashboards - настройки дашбордов
# ───────────────────────────────────────────────────────────────────
[dashboards]
# Версионирование дашбордов (сохранение истории изменений)
versions_to_keep = 20

# Минимальное время обновления дашборда (защита от слишком частых обновлений)
min_refresh_interval = 5s

# Стандартная home dashboard (можно переопределить через UI)
# default_home_dashboard_path =

# ───────────────────────────────────────────────────────────────────
# Unified Alerting - система алертов (Grafana 8+)
# Примечание: Legacy Alerting [alerting] удален в Grafana 12
# ───────────────────────────────────────────────────────────────────
[unified_alerting]
# Включить Unified Alerting (по умолчанию true в Grafana 12)
enabled = true

# ───────────────────────────────────────────────────────────────────
# Date Formats - форматы даты и времени
# ───────────────────────────────────────────────────────────────────
[date_formats]
# Полный формат даты с временем
full_date = MMM Do, YYYY @ HH:mm:ss

# Интервал для секунд
interval_second = HH:mm:ss

# Интервал для минут
interval_minute = HH:mm

# Интервал для часов
interval_hour = MMM DD HH:mm

# Интервал для дней
interval_day = MMM DD

# Интервал для месяцев
interval_month = YYYY-MM

# Интервал для лет
interval_year = YYYY

# Первый день недели (0 = воскресенье, 1 = понедельник)
default_week_start = monday

# Часовой пояс по умолчанию
default_timezone = Asia/Almaty

# ───────────────────────────────────────────────────────────────────
# Plugins - настройки плагинов
# ───────────────────────────────────────────────────────────────────
[plugins]
# Включить установку плагинов
enable_alpha = false

# Разрешить загрузку неподписанных плагинов (по умолчанию отключено)
allow_loading_unsigned_plugins = false

# ───────────────────────────────────────────────────────────────────
# Feature Toggles - экспериментальные функции
# ───────────────────────────────────────────────────────────────────
[feature_toggles]
# Включить публичные дашборды (если нужно)
# publicDashboards = true

# Включить новый навигационный UI
# newNavigation = true

# ───────────────────────────────────────────────────────────────────
# Panels - настройки панелей
# ───────────────────────────────────────────────────────────────────
[panels]
# Отключить санитизацию HTML в текстовых панелях (осторожно!)
disable_sanitize_html = false

# ───────────────────────────────────────────────────────────────────
# Database - настройки базы данных (по умолчанию SQLite)
# ───────────────────────────────────────────────────────────────────
[database]
# Тип БД: sqlite3, mysql, postgres
type = sqlite3

# Путь к SQLite БД
path = /var/lib/grafana/grafana.db

# Максимальное количество соединений
max_open_conn = 100

# Максимальное количество idle соединений
max_idle_conn = 100

# ───────────────────────────────────────────────────────────────────
# Session - настройки сессий
# ───────────────────────────────────────────────────────────────────
[session]
# Провайдер сессий: memory, file, redis, mysql, postgres
provider = file

# Директория для хранения сессий
provider_config = /var/lib/grafana/sessions

# Cookie имя
cookie_name = grafana_sess

# Cookie secure (автоматически true если используется HTTPS)
cookie_secure = true

# Время жизни сессии (в секундах) - 7 дней
session_life_time = 604800

# ───────────────────────────────────────────────────────────────────
# Dataproxy - настройки прокси для datasource запросов
# ───────────────────────────────────────────────────────────────────
[dataproxy]
# Логирование запросов к datasources
logging = false

# Timeout для datasource запросов (в секундах)
timeout = 300

# Максимальное количество idle соединений
max_idle_connections = 100

# ───────────────────────────────────────────────────────────────────
# Rendering - рендеринг изображений (для алертов и экспорта)
# ───────────────────────────────────────────────────────────────────
[rendering]
# URL сервиса рендеринга (если используется grafana-image-renderer)
# server_url = http://renderer:8081/render

# Callback URL для Grafana
# callback_url = http://grafana:3000/

# ───────────────────────────────────────────────────────────────────
# Snapshots - настройки снэпшотов дашбордов
# ───────────────────────────────────────────────────────────────────
[snapshots]
# Включить внешние снэпшоты (публикация на snapshot.raintank.io)
external_enabled = false

# ───────────────────────────────────────────────────────────────────
# Live - настройки Grafana Live (real-time)
# ───────────────────────────────────────────────────────────────────
[live]
# Максимальное количество соединений
max_connections = 100

# Разрешенные origins для WebSocket
# allowed_origins =

# ═══════════════════════════════════════════════════════════════════
# Примечания:
# ═══════════════════════════════════════════════════════════════════
#
# 1. Пароль admin НЕ ДОЛЖЕН быть в этом файле!
#    Используй environment variables через .env:
#    - GF_SECURITY_ADMIN_PASSWORD=your_secure_password
#
# 2. Timezone и locale:
#    - Часовой пояс: Asia/Almaty (Алматы, UTC+6)
#    - Первый день недели: Понедельник
#    - Язык: Английский (по умолчанию)
#
# 3. Организация:
#    - Название: Proflyder
#    - Автоматическое создание при первом запуске
#
# 4. Безопасность:
#    - Регистрация отключена (allow_sign_up = false)
#    - Анонимный доступ отключен
#    - Работа только через HTTPS + nginx
#
# 5. API Keys для annotations:
#    Создаются через UI: Configuration → API Keys
#
# ═══════════════════════════════════════════════════════════════════
